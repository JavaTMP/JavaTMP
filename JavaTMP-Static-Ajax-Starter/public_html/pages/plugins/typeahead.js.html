<div class="dynamic-ajax-content">
    <div class="page-header">
        <h1>typeahead.js</h1>
    </div>
    <div class="row">
        <div class="col-lg-12">
            <div class="alert alert-info">
                <p>a flexible JavaScript library that provides a strong foundation for building robust typeaheads.</p>
                <br/>
                <p>
                    <a class="btn btn-info" target="_blank" href="http://twitter.github.io/typeahead.js/examples/">Demo Page</a>
                    <a class="btn btn-info" target="_blank" href="https://github.com/twitter/typeahead.js">github.com Page</a>
                    <a class="btn btn-info" target="_blank" href="https://github.com/twitter/typeahead.js/blob/master/doc/jquery_typeahead.md">Important Doc Page</a>
                </p>
            </div>
            <div class="card my-3" id="typeahead-panel-demo-id">
                <div class="card-header">
                    Examples
                    <div class="options float-right">
                        <a class="settings"><i class="fa fa-cog"></i></a>
                        <a href="#" class="collapse"><i class="fa fa-chevron-up"></i></a>
                        <a href="#" class="reload"><i class="fa fa-sync"></i></a>
                        <a href="#" class="fullscreen"><i class=" fa fa-expand"></i></a>
                        <a href="#" class="remove"><i class="fa fa-times"></i></a>
                    </div>
                </div>
                <div class="card-body">
                    <div class="row">
                        <div class="col-lg-12">
                            <form action="#" method="post" role="form" class="form-horizontal">
                                <div class="form-group">
                                    <label class="col-md-3 control-label">States of USA</label>
                                    <div class="col-md-6">
                                        <input autocomplete="false" class="form-control typeahead" id="the-basics"
                                               placeholder="States of USA" type="text" />
                                        <p class="help-block">The Basics example</p>
                                    </div>
                                </div>
                                <div class="form-group">
                                    <label class="col-md-3 control-label">States of USA</label>
                                    <div class="col-md-6">
                                        <input autocomplete="off" class="form-control typeahead" id="bloodhound"
                                               placeholder="States of USA" type="text" />
                                        <p class="help-block">using Bloodhound (Suggestion Engine)</p>
                                    </div>
                                </div>
                                <div class="form-group">
                                    <label class="col-md-3 control-label">Countries</label>
                                    <div class="col-md-6">
                                        <input autocomplete="off" class="form-control typeahead" id="prefetch"
                                               placeholder="Countries" type="text" />
                                        <p class="help-block">Data is fetched and processed on initialization</p>
                                    </div>
                                </div>
                                <div class="form-group">
                                    <label class="col-md-3 control-label">Countries</label>
                                    <div class="col-md-6">
                                        <input autocomplete="off" class="form-control typeahead" id="scrollable-dropdown-menu"
                                               placeholder="Countries" type="text" />
                                        <p class="help-block">Scrollable Dropdown Menu</p>
                                    </div>
                                </div>
                                <div class="form-group">
                                    <label class="col-md-3 control-label">Oscar winners</label>
                                    <div class="col-md-6">
                                        <input autocomplete="off" class="form-control typeahead" id="remote"
                                               placeholder="Oscar winners for Best Picture" type="text" />
                                        <p class="help-block">Remotely fetching suggestions</p>
                                    </div>
                                </div>
                                <div class="form-group">
                                    <label class="col-md-3 control-label">Oscar winners</label>
                                    <div class="col-md-6">
                                        <input autocomplete="off" class="form-control typeahead" id="custom-templates"
                                               placeholder="Oscar winners for Best Picture" type="text" />
                                        <p class="help-block">Custom templates give you full control over how suggestions get rendered making it easy to customize the look and feel of your typeahead</p>
                                    </div>
                                </div>
                                <div class="form-group">
                                    <label class="col-md-3 control-label">NFL Teams</label>
                                    <div class="col-md-6">
                                        <input autocomplete="off" class="form-control typeahead" id="default-suggestions"
                                               placeholder="NFL Teams" type="text" />
                                        <p class="help-block">Default suggestions can be shown for empty queries by setting the minLength option to 0 and having the source return suggestions for empty queries.</p>
                                    </div>
                                </div>
                                <div class="form-group">
                                    <label class="col-md-3 control-label">NBA and NHL teams</label>
                                    <div class="col-md-6">
                                        <input autocomplete="off" class="form-control typeahead" id="multiple-datasets"
                                               placeholder="NBA and NHL teams" type="text" />
                                        <p class="help-block">Multiple Datasets</p>
                                    </div>
                                </div>
                                <div class="form-group">
                                    <label class="col-md-3 control-label">RTL Support</label>
                                    <div class="col-md-6">
                                        <input autocomplete="off" class="form-control typeahead" id="rtl-support"
                                               placeholder="NBA and NHL teams" type="text" />
                                        <p class="help-block">RTL and Arabic Support</p>
                                    </div>
                                </div>
                            </form>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
    <link href="assets/css/plugins/custom-typeahead.js.min.css" rel="stylesheet" type="text/css"/>
    <style type="text/css">
        #typeahead-panel-demo-id {
            padding-bottom: 200px;
        }
        .twitter-typeahead, .tt-hint, .tt-input, .tt-menu {
            width: 100%;
        }

        #custom-templates .empty-message {
            padding: 5px 10px;
            text-align: center;
        }

        #multiple-datasets .league-name {
            margin: 0 20px 5px 20px;
            padding: 3px 0;
            border-bottom: 1px solid #ccc;
        }

        #scrollable-dropdown-menu ~ .tt-menu {
            max-height: 150px;
            overflow-y: auto;
        }

        #custom-templates .empty-message {
            padding: 5px 10px;
            text-align: center;
        }

        #multiple-datasets ~ .tt-menu .league-name {
            margin: 0 10px 5px 10px;
            padding: 3px 0;
            border-bottom: 1px solid #ccc;
        }

        #rtl-support .tt-menu {
            text-align: right;
        }

    </style>
    <script src="components/typeahead.js/dist/typeahead.bundle.min.js"></script>
    <script type="text/javascript">
        jQuery(function ($) {
            $(javatmp.settings.defaultOutputSelector).on(javatmp.settings.javaTmpAjaxContainerReady, function (event) {
                var substringMatcher = function (strs) {
                    return function findMatches(q, cb) {
                        var matches, substringRegex;

                        // an array that will be populated with substring matches
                        matches = [];

                        // regex used to determine if a string contains the substring `q`
                        substrRegex = new RegExp(q, 'i');

                        // iterate through the pool of strings and for any string that
                        // contains the substring `q`, add it to the `matches` array
                        $.each(strs, function (i, str) {
                            if (substrRegex.test(str)) {
                                matches.push(str);
                            }
                        });

                        cb(matches);
                    };
                };

                var states = ['Alabama', 'Alaska', 'Arizona', 'Arkansas', 'California',
                    'Colorado', 'Connecticut', 'Delaware', 'Florida', 'Georgia', 'Hawaii',
                    'Idaho', 'Illinois', 'Indiana', 'Iowa', 'Kansas', 'Kentucky', 'Louisiana',
                    'Maine', 'Maryland', 'Massachusetts', 'Michigan', 'Minnesota',
                    'Mississippi', 'Missouri', 'Montana', 'Nebraska', 'Nevada', 'New Hampshire',
                    'New Jersey', 'New Mexico', 'New York', 'North Carolina', 'North Dakota',
                    'Ohio', 'Oklahoma', 'Oregon', 'Pennsylvania', 'Rhode Island',
                    'South Carolina', 'South Dakota', 'Tennessee', 'Texas', 'Utah', 'Vermont',
                    'Virginia', 'Washington', 'West Virginia', 'Wisconsin', 'Wyoming'
                ];

                $('#the-basics').typeahead({hint: true, highlight: true, minLength: 1}, {
                    name: 'states',
                    source: substringMatcher(states),
                    updater: function (item) {
                        console.log(item);
                        console.log(JSON.stringify(item));
                        return item;
                    }
                });

                // constructs the suggestion engine
                var states = new Bloodhound({
                    datumTokenizer: Bloodhound.tokenizers.whitespace,
                    queryTokenizer: Bloodhound.tokenizers.whitespace,
                    // `states` is an array of state names defined in "The Basics"
                    local: states
                });

                $('#bloodhound').typeahead({hint: true, highlight: true, minLength: 1}, {
                    name: 'states',
                    source: states
                });

                var countries = new Bloodhound({
                    datumTokenizer: Bloodhound.tokenizers.whitespace,
                    queryTokenizer: Bloodhound.tokenizers.whitespace,
                    // url points to a json file that contains an array of country names, see
                    // https://github.com/twitter/typeahead.js/blob/gh-pages/data/countries.json
                    prefetch: 'assets/data/countries.json'
                });

                // passing in `null` for the `options` arguments will result in the default
                // options being used
                $('#prefetch').typeahead({hint: true, highlight: true, minLength: 1}, {
                    name: 'countries',
                    source: countries
                });

                $('#scrollable-dropdown-menu').typeahead({hint: true, highlight: true, minLength: 1}, {
                    name: 'countries',
                    limit: 10,
                    source: countries
                });

                var bestPictures = new Bloodhound({
                    datumTokenizer: Bloodhound.tokenizers.whitespace,
                    queryTokenizer: Bloodhound.tokenizers.whitespace,
//                    prefetch: 'assets/data/post_1960.json',
                    remote: {
                        url: 'assets/data/post_1960.json?q=%QUERY%',
                        wildcard: '%QUERY%'
                    }
                });

                $('#remote').typeahead(null, {
                    name: 'best-pictures',
                    display: 'value',
                    source: bestPictures
                });

                $('#custom-templates').typeahead(null, {
                    name: 'best-pictures',
                    display: 'value',
                    source: bestPictures,
                    templates: {
                        empty: [
                            '<div class="empty-message">',
                            'unable to find any Best Picture winners that match the current query',
                            '</div>'
                        ].join('\n'),
                        suggestion: function (data) {
                            return '<p><strong>' + data.value + '</strong> – ' + data.year + '</p>';
                        }
                    }
                });

                var nflTeams = new Bloodhound({
                    datumTokenizer: Bloodhound.tokenizers.obj.whitespace('team'),
                    queryTokenizer: Bloodhound.tokenizers.whitespace,
                    identify: function (obj) {
                        return obj.team;
                    },
                    prefetch: 'assets/data/nfl.json'
                });

                function nflTeamsWithDefaults(q, sync) {
                    if (q === '') {
                        sync(nflTeams.get('Detroit Lions', 'Green Bay Packers', 'Chicago Bears'));
                    } else {
                        nflTeams.search(q, sync);
                    }
                }

                $('#default-suggestions').typeahead({
                    minLength: 0,
                    highlight: true
                },
                        {
                            name: 'nfl-teams',
                            display: 'team',
                            source: nflTeamsWithDefaults
                        });

                var nbaTeams = new Bloodhound({
                    datumTokenizer: Bloodhound.tokenizers.obj.whitespace('team'),
                    queryTokenizer: Bloodhound.tokenizers.whitespace,
                    prefetch: 'assets/data/nba.json'
                });

                var nhlTeams = new Bloodhound({
                    datumTokenizer: Bloodhound.tokenizers.obj.whitespace('team'),
                    queryTokenizer: Bloodhound.tokenizers.whitespace,
                    prefetch: 'assets/data/nhl.json'
                });

                $('#multiple-datasets').typeahead({
                    highlight: true
                },
                        {
                            name: 'nba-teams',
                            display: 'team',
                            source: nbaTeams,
                            templates: {
                                header: '<h3 class="league-name">NBA Teams</h3>'
                            }
                        },
                        {
                            name: 'nhl-teams',
                            display: 'team',
                            source: nhlTeams,
                            templates: {
                                header: '<h3 class="league-name">NHL Teams</h3>'
                            }
                        });

                var arabicPhrases = new Bloodhound({
                    datumTokenizer: Bloodhound.tokenizers.whitespace,
                    queryTokenizer: Bloodhound.tokenizers.whitespace,
                    local: [
                        "الإنجليزية",
                        "نعم",
                        "لا",
                        "مرحبا",
                        "أهلا"
                    ]
                });

                $('#rtl-support').typeahead({hint: true, highlight: true, minLength: 1}, {
                    name: 'arabic-phrases',
                    source: arabicPhrases
                });

                $('.typeahead').on("typeahead:select", function (event, obj) {
                    console.log(JSON.stringify(obj));
                });

            });

            $(javatmp.settings.defaultOutputSelector).on(javatmp.settings.javaTmpContainerResizeEventName, function (event) {

            });
            $(javatmp.settings.defaultOutputSelector).on(javatmp.settings.cardFullscreenCompress, function (event, card) {
                // when card compress by pressing the top right tool button

            });
            $(javatmp.settings.defaultOutputSelector).on(javatmp.settings.cardFullscreenExpand, function (event, card) {
                // when card Expand by pressing the top right tool button
            });
            // before container replaced with new ajax content.
            $(javatmp.settings.defaultOutputSelector).on(javatmp.settings.javaTmpContainerRemoveEventName, function (event) {
                $(javatmp.settings.defaultOutputSelector).off(javatmp.settings.cardFullscreenCompress);
                $(javatmp.settings.defaultOutputSelector).off(javatmp.settings.cardFullscreenExpand);
                return true;
            });
        });
    </script>
</div>
